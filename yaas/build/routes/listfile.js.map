{"version":3,"sources":["routes/listfile.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;gCAQ6B,sBAAsB;;;;wBACtB,UAAU;;;;uBACV,SAAS;;;;oBACT,MAAM;;;;uBACN,UAAU;;;;sBACV,QAAQ;;;;AAErC,SAAS,QAAQ,CAAE,GAAG,EAAE,GAAG,EAAE;;;AAGzB,QAAI,GAAG,GAAG,cAAc,CAAC;;;AAGzB,QAAI,cAAc,GAAG,8BAAa,WAAW,EAAE,CAAC;;AAEhD,WAAO,0BAAY,UAAC,OAAO,EAAK;;;AAG5B,YAAI,MAAM,GAAG,cAAc,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;;;AAGlE,cAAM,CAAC,IAAI,EAAE,CAAC,OAAO,CAAC,UAAU,GAAG,EAAE,IAAI,EAAE;AACvC,gBAAI,IAAI,GAAG,EAAE,CAAC;;;;;;AACd,qCAAe,IAAI,8HAAE;wBAAb,GAAG;;;AAGP,wBAAI,CAAC,IAAI,CAAC,0BAAQ,cAAc,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,EAC/C,GAAG,CAAC,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,YAAY,CAAC,CAAC,CAAC;iBAC7C;;;;;;;;;;;;;;;;AACD,eAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAClB,CAAC,CAAC;AACH,eAAO,CAAC,EAAG,CAAC,CAAC;KAChB,CAAC,CAAC;CACN;;qBAEc,QAAQ","file":"routes/listfile.js","sourcesContent":["/**\n * Created by r1cebank on 8/22/15.\n */\n\n/*!\n *  This is the list file route, which will output all the files in a bucket\n */\n\nimport AppSingleton     from '../util/appsingleton';\nimport Promise          from 'bluebird';\nimport Shortid          from 'shortid';\nimport Path             from 'path';\nimport UrlJoin          from 'url-join';\nimport _                from 'lodash';\n\nfunction listfile (req, res) {\n\n    //  Log tag\n    let TAG = \"route:upload\";\n\n    //  Get shared instance from singleton\n    var sharedInstance = AppSingleton.getInstance();\n\n    return new Promise((resolve) => {\n\n        //  Open this Nedb so a find query can be executed later\n        var bucket = sharedInstance.buckets.collection(req.params.bucket);\n\n        //  Using {} will yield us all the records in the bucket\n        bucket.find().toArray(function (err, docs) {\n            var urls = [];\n            for(let doc of docs) {\n\n                //  All we want is a array of urls back to the client\n                urls.push(UrlJoin(sharedInstance.config.server.host,\n                    req.params.bucket, doc.originalname));\n            }\n            res.send(urls);\n        });\n        resolve({ });\n    });\n}\n\nexport default listfile;"],"sourceRoot":"/source/"}